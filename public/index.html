<div>
  <p><strong>Paste a Cloudinary image URL</strong> 
     (or a public_id path like 
     <code>chiefs-luau/2025/September/09.28.2025/CH0928251007</code>) 
     then click Load.</p>
  <input id="inp" style="width: 600px" placeholder="Full URL or public_id path" />
  <button id="goBtn">Load</button>
  <div id="msg" style="margin-top:8px;color:#888"></div>
  <div id="row" style="display:flex;gap:12px;margin-top:12px"></div>
</div>

<script>
  const CLOUD = "dvqpndvej"; // ðŸ‘ˆ replace with your cloud name if different
  const row = document.getElementById("row");
  const msg = document.getElementById("msg");

  function toPublicId(input) {
    if (/res\.cloudinary\.com/.test(input)) {
      const m = input.match(/\/image\/upload\/(?:v\d+\/)?(.+?)(?:\.\w+)?$/);
      return m ? m[1] : input;
    }
    return input;
  }

  function plusMinusOne(id) {
    const digits = (id.match(/(\d+)$/) || [])[1] || "";
    const prefix = id.slice(0, id.length - digits.length);
    const n = parseInt(digits || "0", 10);
    return [`${prefix}${n-1}`, id, `${prefix}${n+1}`];
  }

  function deliveryUrl(pubId) {
    return `https://res.cloudinary.com/${CLOUD}/image/upload/${pubId}.jpg`;
  }

  function loadImg(url) {
    return new Promise((resolve) => {
      const img = new Image();
      img.onload = () => resolve({ ok: true, url });
      img.onerror = () => resolve({ ok: false, url });
      img.src = url;
    });
  }

  document.getElementById("goBtn").onclick = async () => {
    row.innerHTML = "";
    msg.textContent = "Checkingâ€¦";

    const raw = document.getElementById("inp").value.trim();
    if (!raw) return;

    const mainPubId = toPublicId(raw);
    const folder = mainPubId.replace(/\/[^/]+$/, "");
    const file   = mainPubId.split("/").pop();
    const [prev, cur, next] = plusMinusOne(file);

    const candidates = [
      `${folder}/${prev}`,
      `${folder}/${cur}`,
      `${folder}/${next}`,
    ];

    const checks = await Promise.all(candidates.map(p => loadImg(deliveryUrl(p))));
    const found = checks.filter(c => c.ok);

    msg.textContent = found.length ? "" : "None of the 3 images existed.";
    for (const c of found) {
      const card = document.createElement("div");
      card.style.width = "320px";
      card.style.border = "1px solid #ddd";
      card.style.borderRadius = "8px";
      card.style.overflow = "hidden";
      card.innerHTML = `
        <img src="${c.url}" style="display:block;width:100%;height:auto" />
        <div style="padding:6px 8px;font:14px system-ui, sans-serif;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;">
          ${c.url.replace(/^https?:\/\/[^/]+\/image\/upload\//,'')}
        </div>`;
      row.appendChild(card);
    }
  };
</script>
